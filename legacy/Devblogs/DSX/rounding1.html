<!DOCTYPE html>

<html>
    <head>
        <title>DSX Rounding Issues, Part 1</title>
        <link rel="stylesheet" href="../devblog.css">
    </head>

    <nav class="topnav">
        <div class="topnavlink" onclick="window.location.href = '../General/generalhome.html';">General</div>
        <div class="topnavlink" onclick="window.location.href = '../DSX/DSXhome.html';">DSX</div>
        <div class="topnavlink" onclick="window.location.href = '../devblog.html';">Devblog homepage</div>
        <div class="topnavlink" onclick="window.location.href = '../../index.html';">SamJD261 homepage</div>
    </nav>

    <body>
        <div class="maintextbox">
            <h1>DSX Rounding Issues, Part 1</h1>

            <p>(Spoiler alert for <i>Office Space</i> btw!!!)</p>

            <h2>1: The bug</h2>
            <p> 
                My bot's buying and selling function has a <b>big</b> rounding problem.
                <br>
                Since the function also changes various financial values related to the shares being bought/sold by the user, sometimes numbers don't divide perfectly. In all honesty, it happens a lot. 
                As you can probably guess, this results in irrational numbers being calculated for new values, and those values are rounded. 
                This is very bad. Why? Well, it's pretty simple. Rounding shaves off (or adds) tiny bits of value from irrational numbers to convert them to rational numbers that are roughly equal to their original (irrational) value. 
                This is fine for general mathematics, but really, <i>really</i> bad for financial maths. Imagine you have 19 rubber ducks. Altogether, they're worth $20 in total. So, the value of one rubber duck is $20/19.
                If you round that value to 2 decimal places, you get $1.06 (which has been rounded up). When you multiply that rounded value by 19 (the number of rubber ducks you have) you get $20.14.
                So, even though the individual cost of each rubber duck has been rounded up by <i>less than a cent</i>, the value of all 19 of the ducks together has already increased by 14 cents.
                Now imagine that at a stock market scale. Worse still, money can be <i>lost</i>.
                That loss of money is an absolute <u>nightmare</u> for my program, and as of yet, I haven't been able to find a viable solution.
                However, I have found quite a lot of information online about the issue my bot has, and as it turns out, it's not exclusive to my code.
            </p>

            <h2>2: The reason for the bug</h2>
            <p>
                If you've watched the movie <i>Office Space</i>, you probably remember the scam they set up to make money off of rounding. The exploit they use to do that is similar to the issue I am having with DSX.
                So basically, there exists a financial problem dubbed the "Hanging Penny Problem". 
                The idea of the problem, as I have outlined with my explanation of DSX's issue, is quite simply that value can be gained from out of nowhere, or lost without a trace, due to the rounding of values.
                As far as I can tell, the only solution is to take the value that is lost by rounding (which should be pretty trivial to find using some subtraction), and holding it as a separate value, which is (as far as I know)
                not linked to the shares in any way whatsoever (so shares cannot buy or sell it), before being redistributed back to either shareholders or the share-dependent value of the company itself when possible,
                depending on the context. However, I cannot stress enough that I don't have a clue if this is the right solution for DSX, and, even if it is, how I can get it to work.
                I personally dub this solution the "external redistribution balance", or "ERB" for short.
                As mind-numbingly boring of a name as that may be, it makes sense to me, so I honestly don't really care how dull it may sound.
            </p>    

            <h2>3: A solution(?)</h2>
            <p>
                Having established the ERB as a potential solution to DSX's case of the Hanging Penny Problem, there still remains the crucial matter of <i>how</i> it would technically work.
                My main idea is to store the original variables for individual and total share value as 2 new variables, which can then be compared to the updated variables
                (after they've been rounded to 2 decimal places) to find a difference for each variable class. My hope is that those differences are the values that have been lost in rounding.
                That difference can then be added to the ERB, which will then continue to accumulate value until its value can be divided evenly amongst all shareholders, with the quotient having no more than 2 decimal places.
                However, this raises some more issues. That ERB value will be deducted from the value of the company's share-inclusive value, which means the share value will decrease- at least as far as I can tell.
                All will be revealed when I can test it, I suppose.
            </p>
        </div>

    </body>